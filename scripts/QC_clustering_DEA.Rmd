---
title: "QC_clustering_DEA"
author: "Charles"
date: '2022-07-28'
output: html_document
editor_options: 
  chunk_output_type: console
---

## Description

This is a public data set with accession number [GSE178318](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi). It consists of a Single-Cell Atlas of Liver Metastases of Colorectal Cancer to Reveal the Reprogramming of the Tumor Microenvironment in Response to Preoperative Chemotherapy.

The goals will change progressively, but for now, one of the principal goals is to check the expression of lymphotoxins in metastasised liver cancer cells from CRC.

## Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## Loading libraries

```{r libraries}
library(Seurat)
library(SeuratObject)
library(SeuratWrappers)
library(SeuratDisk)
library(ggplot2)
library(tidyverse)
library(openxlsx)
library(Matrix)
```

## 1. Preparation for quality control

### 1. Load in the raw data and add relevant data and metadata

```{r data_loading}
# check files
list.files("rawData")

barcodes <- read.table("rawData/GSE178318_barcodes.tsv", header = FALSE, sep = "\t")
head(barcodes)

genes <- read.table("rawData/GSE178318_genes.tsv", header = FALSE, sep = "\t")
head(genes)

raw_matrix <- readMM("rawData/GSE178318_matrix.mtx")
dim(raw_matrix)

# set row names and column names
rownames(raw_matrix) <- genes$V2
colnames(raw_matrix) <- barcodes$V1

# verify row names and column names 
rownames(raw_matrix)[1:10]
colnames(raw_matrix)[1:10]
``` 

The data set has been loading and prepared. Now I proceed to the quality control.
